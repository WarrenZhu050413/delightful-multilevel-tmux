#!/bin/bash
# tmux-level-help - Show escape commands for current level

# Source configuration
CONFIG_FILE="$HOME/.local/bin/tmux-multilevel/config.sh"
if [[ -f "$CONFIG_FILE" ]]; then
    source "$CONFIG_FILE"
else
    # Fallback to defaults if config doesn't exist
    PRIMARY_PREFIX="C-x"
    SECONDARY_PREFIX="C-a"
fi

current_level=$(tmux show-option -gv @current_level 2>/dev/null || echo "1")

# Extract the key letter from the prefix (e.g., C-x -> x, M-a -> a)
primary_key="${PRIMARY_PREFIX#*-}"
secondary_key="${SECONDARY_PREFIX#*-}"

echo "=== TMUX LEVEL $current_level HELP ==="
echo "Primary Prefix: $PRIMARY_PREFIX (active sessions)"
echo "Secondary Prefix: $SECONDARY_PREFIX (passthrough)"
echo ""
echo "ESCAPE COMMANDS:"
echo "  $PRIMARY_PREFIX !        → Jump to Level 1"  
echo "  Ctrl+B          → Up one level"
echo "  Ctrl+V          → Down one level"
echo "  $PRIMARY_PREFIX x        → Copy mode (preserved)"
echo ""
echo "DIRECT JUMPS:"
echo "  $PRIMARY_PREFIX ! @ # $ % ^ & * ( → Levels 1-9"
echo ""
echo "STATUS BAR FORMATS:"
echo "  tmux-level-status --visual   → [L3:$primary_key ●●●○○○○○○]"
echo "  tmux-level-status --compact  → [L3:$primary_key]"
echo "  tmux-level-status --help     → Show format options"
echo ""
echo "If stuck, run: ~/.local/bin/tmux-multilevel/core/tmux-level-reset"